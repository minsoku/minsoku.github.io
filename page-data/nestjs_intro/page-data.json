{"componentChunkName":"component---src-templates-blog-template-js","path":"/nestjs_intro/","result":{"data":{"cur":{"id":"96e7f105-0f88-58e2-ad61-b6d371cceb99","html":"<ul>\n<li><a href=\"https://nestjs.com/\">Nestjs</a>ëŠ” íš¨ìœ¨ì ì´ê³  ìŠ¤ì¼€ì¼ë§ì´ ì‰¬ìš´ nodejs ì„œë²„ë¥¼ ë§Œë“œëŠ”ë° ì‚¬ìš©í•˜ëŠ” í”„ë ˆì„ì›Œí¬ì´ë‹¤.</li>\n<li>ì°¨ì„¸ëŒ€ Javascriptë¥¼ ì‚¬ìš©í•˜ë©° Typescriptë¡œ ë§Œë“¤ì–´ì¡Œìœ¼ë©° Typescriptë¥¼ ì™„ì „íˆ ì§€ì›í•œë‹¤.</li>\n<li>NestjsëŠ” Express ê°™ì€ ê²¬ê³ í•œ HTTP ì„œë²„ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë©° ì›í•œë‹¤ë©´ Fastifyë¥¼ ëŒ€ì‹  ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>\n<li>ìƒë‹¹íˆ ë§ì€ Nodejs ë¼ì´ë¸ŒëŸ¬ë¦¬, í—¬í¼, íˆ´ë“¤ì´ ìˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³  ì•„í‚¤í…ì²˜ ì„¤ê³„ì— ëŒ€í•œ ë¬¸ì œë¥¼ í•´ê²°í•´ì£¼ëŠ” í•´ê²°ì±…ì€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>\n<li>NestjsëŠ” ìì²´ì ìœ¼ë¡œ ì„œë²„ ì•„í‚¤í…ì³ë¥¼ ì œê³µí•´ì¤€ë‹¤. ê·¸ë˜ì„œ í…ŒìŠ¤íŠ¸í•˜ê¸° ì‰½ê³ , ë””ì»¤í”Œë§ì´ ì˜ ë˜ì–´ìˆê³ , ìœ ì§€ë³´ìˆ˜ê°€ í¸í•œ ì„œë²„ë¥¼ ì œì‘í•˜ê²Œ í•´ì¤€ë‹¤.</li>\n</ul>\n<h1 id=\"nestjs-lifecycle\" style=\"position:relative;\"><a href=\"#nestjs-lifecycle\" aria-label=\"nestjs lifecycle permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nestjs LifeCycle</h1>\n<p><img src=\"https://velog.velcdn.com/images/minsoku03/post/b67672cd-fdea-4067-ab80-02e15b3ffdb3/image.png\" alt=\"Nestjs LifeCycle\"></p>\n<h2 id=\"pipe\" style=\"position:relative;\"><a href=\"#pipe\" aria-label=\"pipe permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Pipe</h2>\n<ul>\n<li>PipeëŠ” Injectable ë°ì½”ë ˆì´í„°ë¡œ ë°ì½”ë ˆì´íŒ… ë˜ì–´ìˆê³ , PipeTransformì´ë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ implementí•œë‹¤.</li>\n<li>ë³€í˜•: ì›í•˜ëŠ” í˜•íƒœë¡œ ë³€í˜•ì‹œì¼œì¤€ë‹¤ ex) string => integer</li>\n<li>ê²€ì¦: ë§Œì•½ì— ìœ íš¨í•œ ë°ì´í„°ë©´ ê·¸ëŒ€ë¡œ ì „ë‹¬í•´ì£¼ê³  ì•„ë‹ ê²½ìš°ì—ëŠ” ì—ëŸ¬ë¥¼ ë˜ì§„ë‹¤.</li>\n</ul>\n<h2 id=\"ì½”ë“œì˜ˆì‹œ\" style=\"position:relative;\"><a href=\"#%EC%BD%94%EB%93%9C%EC%98%88%EC%8B%9C\" aria-label=\"ì½”ë“œì˜ˆì‹œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì½”ë“œì˜ˆì‹œ</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">test.pipe.ts\n\nimport {\n    ArgumentMetadata,\n    BadRequestException,\n    Injectable,\n    PipeTransform,\n} from '@nestjs/common';\n\n@Injectable()\nexport class TestPipe implements PipeTransform {\n    transform(value: any, metadata: ArgumentMetadata) {\n        if (value.content.toString().length > 10) {\n            throw new BadRequestException(\n                'contentëŠ” 10ì ë¯¸ë§Œìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”',\n            );\n        }\n        return value.toString();\n    }\n}</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">app.controller.ts\n\n@Controller()\nexport class AppController {\n    constructor(private readonly appService: AppService) {}\n\n    @Get()\n    @UsePipes(TestPipe)\n    getHello(@Body() body: Ibody): string {\n        console.log(body);\n        return 'ì„±ê³µ';\n    }\n}</code></pre></div>\n<h3 id=\"ê²°ê³¼\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EA%B3%BC\" aria-label=\"ê²°ê³¼ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê²°ê³¼</h3>\n<blockquote>\n<p>â€œmessageâ€: â€œcontentëŠ” 10ì ë¯¸ë§Œìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”â€,</p>\n</blockquote>\n<blockquote>\n<p>â€œerrorâ€: â€œBad Requestâ€,</p>\n</blockquote>\n<blockquote>\n<p>â€œstatusCodeâ€: 400</p>\n</blockquote>\n<h2 id=\"guard\" style=\"position:relative;\"><a href=\"#guard\" aria-label=\"guard permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Guard</h2>\n<ul>\n<li>GuardëŠ” ì‰½ê²Œ ë§í•˜ë©´ ë³´í˜¸í•˜ëŠ” ì—­í• </li>\n<li>GuardëŠ” api ìš”ì²­ì´ ë“¤ì–´ê°”ì„ ë•Œ (Controller, Service, Repository) ë¡œì§ ì²˜ë¦¬ ë¶€ë¶„ê¹Œì§€ ê°ˆ ìˆ˜ ìˆëƒ ì—†ëƒë¥¼ ê²°ì •í•˜ê²Œ í•´ì£¼ëŠ” ìš”ì†Œë‹¤.</li>\n<li>Pipeê°€ ì ìš©ì´ ë˜ê¸° í›¨ì”¬ ì „ì— Guardê°€ ë¨¼ì € ì ìš©ì´ ë¼ì„œ ë§Œì•½ì— Guardì—ì„œ ì´ë²ˆ ìš”ì²­ì€ ë“¤ì–´ê°ˆ ìˆ˜ê°€ ì—†ì–´ë¼ê³  íŒë‹¨ì„ í•œë‹¤ë©´ íŒŒì´í”„ê¹Œì§€ì˜ ìš”ì²­ì´ ì´ì–´ì§€ì§€ë„ ì•ŠëŠ”ë‹¤.</li>\n<li>Guardë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒì€ Pipeë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒê³¼ êµ‰ì¥íˆ ë¹„ìŠ·í•˜ë‹¤.</li>\n<li>Injectable ë°ì½”ë ˆì´í„°ë¡œ ë°ì½”ë ˆì´íŒ…í•˜ê³ , CanActivateë¼ëŠ” íƒ€ì…ì„ implementë¥¼ í•´ì¤€ë‹¤.</li>\n</ul>\n<h2 id=\"ì½”ë“œì˜ˆì‹œ-1\" style=\"position:relative;\"><a href=\"#%EC%BD%94%EB%93%9C%EC%98%88%EC%8B%9C-1\" aria-label=\"ì½”ë“œì˜ˆì‹œ 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì½”ë“œì˜ˆì‹œ</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">test.guard.ts\n\nimport {\n    CanActivate,\n    ExecutionContext,\n    Injectable,\n    UnauthorizedException,\n} from '@nestjs/common';\n\n@Injectable()\nexport class TestGuard implements CanActivate {\n    canActivate(context: ExecutionContext): boolean {\n        const req = context.switchToHttp().getRequest();\n        const token = req.headers['authorization'];\n        if (!token) {\n            throw new UnauthorizedException('í† í°ì´ ì—†ìŠµë‹ˆë‹¤ !!!!');\n        }\n        return true;\n    }\n}</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">app.controller.ts\n\n@Controller()\nexport class AppController {\n    constructor(private readonly appService: AppService) {}\n    @Get()\n    @UsePipes(TestPipe)\n    @UseGuards(TestGuard)\n    getHello(@Body() body: Ibody): string {\n        console.log(body);\n        return 'ì„±ê³µ';\n    }\n}</code></pre></div>\n<h2 id=\"ê²°ê³¼-1\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EA%B3%BC-1\" aria-label=\"ê²°ê³¼ 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê²°ê³¼</h2>\n<ul>\n<li>Autorizationì„ ì•ˆ ë„£ì—ˆì„ ë•Œ</li>\n</ul>\n<p><img src=\"https://velog.velcdn.com/images/minsoku03/post/a5f9eeaa-ab9d-4efa-b469-31c4d57451dd/image.png\" alt=\"Guard Autorization\"></p>\n<ul>\n<li>Autorizationì„ ë„£ì—ˆì„ ë•Œ</li>\n</ul>\n<p><img src=\"https://velog.velcdn.com/images/minsoku03/post/ae49af58-8478-480c-8742-968275504912/image.png\" alt=\"Guard Autorization\"></p>\n<h2 id=\"interceptor\" style=\"position:relative;\"><a href=\"#interceptor\" aria-label=\"interceptor permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Interceptor</h2>\n<ul>\n<li>ë©”ì„œë“œë¥¼ ì‹¤í–‰í•˜ê¸° ì „ê³¼ í›„ë¡œ ìš°ë¦¬ê°€ ì¶”ê°€ ë¡œì§ì„ ì‘ì„±ì„ í•  ìˆ˜ê°€ ìˆë‹¤.</li>\n<li>í•¨ìˆ˜ì—ì„œ ë°˜í™˜ëœ ê²°ê³¼ë¥¼ ìš°ë¦¬ê°€ ë³€í˜•í•  ìˆ˜ ìˆë‹¤.</li>\n<li>í•¨ìˆ˜ì—ì„œ ë˜ì§„ ì—ëŸ¬ë¥¼ ìš°ë¦¬ê°€ ë³€í˜•í•  ìˆ˜ ìˆë‹¤.</li>\n<li>ê¸°ë³¸ìœ¼ë¡œ ì‘ì„±í•´ë†“ì€ í•¨ìˆ˜ë¡œì§ì— ì¶”ê°€ ê¸°ëŠ¥ì„ ë„£ì„ ìˆ˜ê°€ ìˆë‹¤.</li>\n<li>ì–´ë–¤ í•¨ìˆ˜ì˜ ê¸°ëŠ¥ì„ ì™„ì „íˆ overrideí•  ìˆ˜ê°€ ìˆë‹¤.</li>\n<li>Nestjs ë¼ì´í”„ì‚¬ì´í´ì—ì„œ ë³¼ ìˆ˜ ìˆëŠ” ëª¨ë“  ê¸°ëŠ¥ ì¤‘ì—ì„œ ìœ ì¼í•˜ê²Œ ìš”ì²­ê³¼ ì‘ë‹µì„ ëª¨ë‘ í•¸ë“¤ë§í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì´ë‹¤.</li>\n<li>ë˜ ë³´í†µ ë¡œê·¸ë¥¼ ìŒ“ëŠ” ê¸°ëŠ¥ì€ Interceptorì—ì„œ ìˆ˜í–‰ëœë‹¤.</li>\n</ul>\n<p><img src=\"https://velog.velcdn.com/images/minsoku03/post/7df6346c-4e2d-4268-a9da-fb00fb029998/image.png\" alt=\"Interceptor\"></p>\n<ul>\n<li>ìœ„ë¥¼ ë³´ë©´ Client Side(App, Web or server)ê°€ ìˆë‹¤.</li>\n<li>ìš”ì²­ì´ ë“¤ì–´ê°€ì„œ Route Handler(í¬ìŠ¤íŠ¸, ê²Œì‹œê¸€ ë“±ë“±) ì—¬ê¸°ë¡œ ìš”ì²­ì´ ë“¤ì–´ê°€ë©´ Interceptorê°€ í•œ ë²ˆ Interceptingì„ í•œë‹¤.</li>\n</ul>\n<p>ì´ ìš”ì²­ì„ ë³€ê²½í•˜ê±°ë‚˜ ê·¸ëŒ€ë¡œ ë‘˜ ìˆ˜ ìˆë‹¤.</p>\n<ul>\n<li>ê·¸ë‹¤ìŒì— ìš”ì²­ì´ processingì´ ë˜ê³  Route Handlerì—ì„œ í•¨ìˆ˜ê°€ ì‹¤í–‰ì´ ë˜ê³  ë‹¤ì‹œ ì‘ë‹µìœ¼ë¡œ Client Sideë¡œ ë³´ë‚´ì§ˆ ë•Œ, ê·¸ë•Œ í•œ ë²ˆ ë” Interceptorê°€ ì ìš©ì´ ëœë‹¤.</li>\n<li>Requestìš© Interceptor, Responseìš© Interceptorë¥¼ ë”°ë¡œ ì‘ì„±ì„ í•˜ëŠ” ê²Œ, ì•„ë‹ˆê³  Interceptor í•˜ë‚˜ì—ì„œ ì´ ë‘ ê°€ì§€ë¥¼ ëª¨ë‘ í•¸ë“¤ë§í•  ìˆ˜ ìˆëŠ” ê²ƒì´ Interceptorì˜ íŠ¹ì¥ì´ë‹¤.</li>\n<li>ExceptionFilter(ì˜ˆì™¸ìƒí™©ì²˜ë¦¬ë¼ ì˜ˆì™¸) Interceptorê°€ ìœ ì¼í•˜ê²Œ ì‘ë‹µê°’ê¹Œì§€ ë³€ê²½ì„ í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì´ë‹¤.</li>\n<li>InterceptorëŠ” Observableì´ë¼ëŠ” ê²ƒì„ ë°˜í™˜í•˜ê³  Rxjsë¥¼ ì‚¬ìš©í•œë‹¤. ê·¸ë¦¬ê³  Injectable ë°ì½”ë ˆì´í„°ë¡œ ë°ì½”ë ˆì´íŒ…í•˜ê³  NestInterceptorë¥¼ implement í•œë‹¤.</li>\n</ul>\n<h2 id=\"ì½”ë“œì˜ˆì‹œ-2\" style=\"position:relative;\"><a href=\"#%EC%BD%94%EB%93%9C%EC%98%88%EC%8B%9C-2\" aria-label=\"ì½”ë“œì˜ˆì‹œ 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì½”ë“œì˜ˆì‹œ</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">test.interceptor.ts\n\nimport {\n    CallHandler,\n    ExecutionContext,\n    Injectable,\n    NestInterceptor,\n} from '@nestjs/common';\nimport { Observable, tap } from 'rxjs';\n\n@Injectable()\nexport class TestInterceptor implements NestInterceptor {\n    intercept(\n        context: ExecutionContext,\n        next: CallHandler&lt;any>,\n    ): Observable&lt;any> {\n        const now = new Date();\n        console.log(`[REQ] ${now.toLocaleString('kr')}`);\n        return next\n            .handle()\n            .pipe(\n                tap((observable) =>\n                    console.log(\n                        `[RES] ${new Date().toLocaleString('kr')} ${\n                            new Date().getMilliseconds() - now.getMilliseconds()\n                        }`,\n                    ),\n                ),\n            );\n    }\n}</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">app.controller.ts\n\n@Controller()\nexport class AppController {\n    constructor(private readonly appService: AppService) {}\n    @Get()\n    @UsePipes(TestPipe)\n    @UseGuards(TestGuard)\n    @UseInterceptors(TestInterceptor)\n    getHello(@Body() body: Ibody): string {\n        return 'ì„±ê³µ';\n    }\n}</code></pre></div>\n<h3 id=\"ê²°ê³¼-2\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EA%B3%BC-2\" aria-label=\"ê²°ê³¼ 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê²°ê³¼</h3>\n<blockquote>\n<p>[REQ] 12/14/2023, 5:33:51 PM</p>\n</blockquote>\n<blockquote>\n<p>[RES] 12/14/2023, 5:33:51 PM 4</p>\n</blockquote>\n<h2 id=\"exceptionfilter\" style=\"position:relative;\"><a href=\"#exceptionfilter\" aria-label=\"exceptionfilter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ExceptionFilter</h2>\n<ul>\n<li>ExceptionFilterëŠ” ë§ ê·¸ëŒ€ë¡œ ì˜ˆì™¸ë¥¼ í•„í„°ë§í•˜ëŠ” ê²ƒì´ë‹¤.</li>\n<li>ì˜ˆì™¸ê°€ ì¼ì–´ë‚¬ì„ ë•Œ ê·¸ íŠ¹ì • ì˜ˆì™¸ë¥¼ ì¡ì•„ ê°€ì§€ê³  í˜•íƒœë¥¼ ë³€ê²½í•œë‹¤ë˜ì§€, íŠ¹ì • ì‘ë‹µì„ ë³´ë‚´ëŠ” ë“±ì˜ ì—¬ëŸ¬ê°€ì§€ ì‘ì—…ì„ í•  ìˆ˜ê°€ ìˆë‹¤.</li>\n<li>ExceptionFilterëŠ” ì—ëŸ¬ì²˜ë¦¬ì— ëŒ€í•œ ë¡œê¹… ë¡œì§ì„ ì‘ì„±í•˜ê¸° ì¢‹ì€ ìœ„ì¹˜ì— ìˆë‹¤.</li>\n<li>ExceptionFilterëŠ” ë¨¼ì € Controller, Service, Repositoryì˜ ë¡œì§ ì²˜ë¦¬ í›„ ExceptionFilterê°€ ì ìš©ì´ ë˜ê³  Interceptorë¡œ ì „ë‹¬ì´ ëœë‹¤.</li>\n<li>ExceptionFilterì—ì„œ ìˆ˜í–‰í•œ ë¶€ë¶„ë“¤ì€ Interceptorì—ì„œ ë§ˆì°¬ê°€ì§€ë¡œ ë˜ ì¶”ê°€ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ê°€ ìˆë‹¤.</li>\n</ul>\n<p><a href=\"https://velog.velcdn.com/images/minsoku03/post/85b9ce03-a85d-4884-b0a7-0812ffc92cad/image.png\">!ExceptionFilter</a></p>\n<ul>\n<li>í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì—ì„œ ìš”ì²­ì„ ë³´ë‚´ê³ , ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ë¶€ë¶„ì—ì„œ ì‘ë‹µì´ ëŒì•„ê°ˆ ë•Œ Filterê°€ ì ìš©ì´ ëœë‹¤.</li>\n</ul>\n<h3 id=\"ì½”ë“œì˜ˆì‹œ-3\" style=\"position:relative;\"><a href=\"#%EC%BD%94%EB%93%9C%EC%98%88%EC%8B%9C-3\" aria-label=\"ì½”ë“œì˜ˆì‹œ 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì½”ë“œì˜ˆì‹œ</h3>\n<ul>\n<li>ExceptionFilterëŠ” Catchë¡œ ë°ì½”ë ˆì´íŒ…ì´ ë˜ê³  ExceptionFilterë¥¼ implementí•œë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">test.exceptionFilter.ts\n\nimport {\n    ArgumentsHost,\n    Catch,\n    ExceptionFilter,\n    HttpException,\n} from '@nestjs/common';\n\n@Catch(HttpException)\nexport class HttpExceptionFilter implements ExceptionFilter {\n    catch(exception: HttpException, host: ArgumentsHost) {\n        const ctx = host.switchToHttp();\n        const response = ctx.getResponse();\n        const request = ctx.getRequest();\n        const status = exception.getStatus();\n\n        response.status(status).json({\n            statusCode: status,\n            message: exception.message,\n            timestamp: new Date().toLocaleDateString('kr'),\n            path: request.url,\n        });\n    }\n}</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">app.controller.ts\n\n@Controller()\nexport class AppController {\n    constructor(private readonly appService: AppService) {}\n    @Get()\n    @UsePipes(TestPipe)\n    @UseGuards(TestGuard)\n    @UseInterceptors(TestInterceptor)\n    @UseFilters(HttpExceptionFilter)\n    getHello(@Body() body: Ibody): string {\n        throw new BadRequestException('ì—ëŸ¬ë¼ê³ í•©ë‹ˆë‹¤ !');\n        return 'ì„±ê³µ';\n    }\n}</code></pre></div>\n<h3 id=\"ê²°ê³¼-3\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EA%B3%BC-3\" aria-label=\"ê²°ê³¼ 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê²°ê³¼</h3>\n<blockquote>\n<p>â€œstatusCodeâ€: 400</p>\n</blockquote>\n<blockquote>\n<p>â€œmessageâ€: â€œì—ëŸ¬ë¼ê³ í•©ë‹ˆë‹¤ !â€</p>\n</blockquote>\n<blockquote>\n<p>â€œtimestampâ€: â€œ12/14/2023â€</p>\n</blockquote>\n<blockquote>\n<p>â€œpathâ€: â€/â€</p>\n</blockquote>\n<ul>\n<li>ì´ë ‡ê²Œ í•˜ë‚˜ì˜ endpointì— ì ìš©í•  ìˆ˜ë„ ìˆê³ , ì „ì²´ì— ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>\n</ul>\n<h3 id=\"ì „ì²´ì—-exceptionfilterë¥¼-ì ìš©í•˜ëŠ”-ì½”ë“œ-ì˜ˆì‹œ\" style=\"position:relative;\"><a href=\"#%EC%A0%84%EC%B2%B4%EC%97%90-exceptionfilter%EB%A5%BC-%EC%A0%81%EC%9A%A9%ED%95%98%EB%8A%94-%EC%BD%94%EB%93%9C-%EC%98%88%EC%8B%9C\" aria-label=\"ì „ì²´ì— exceptionfilterë¥¼ ì ìš©í•˜ëŠ” ì½”ë“œ ì˜ˆì‹œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì „ì²´ì— ExceptionFilterë¥¼ ì ìš©í•˜ëŠ” ì½”ë“œ ì˜ˆì‹œ</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">main.ts\n\nimport { NestFactory } from '@nestjs/core';\nimport { AppModule } from './app.module';\nimport { HttpExceptionFilter } from 'src/exception-filter/test.exceptionFilter';\n\nasync function bootstrap() {\n    const app = await NestFactory.create(AppModule);\n    await app.listen(3000);\n\n    app.useGlobalFilters(new HttpExceptionFilter());\n}\nbootstrap();</code></pre></div>\n<h2 id=\"middleware\" style=\"position:relative;\"><a href=\"#middleware\" aria-label=\"middleware permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Middleware</h2>\n<p>MiddleWareê°€ ê°€ì¥ ë¨¼ì € ìš”ì²­ì„ ë°›ëŠ” ì—­í• ì„ í•œë‹¤.</p>\n<ul>\n<li>ì–´ë–¤ ì½”ë“œë“  ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.</li>\n<li>ìš”ì²­ê³¼ ì‘ë‹µ ê°ì²´ì˜ ë³€í™”ë¥¼ ìš°ë¦¬ê°€ ë§Œë“¤ì–´ ì¤„ ìˆ˜ ìˆë‹¤. (ë¬´ì–¸ê°€ë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ì‚­ì œí•˜ê±°ë‚˜ ì—…ë°ì´íŠ¸ê°€ ê°€ëŠ¥)</li>\n<li>ìš”ì²­ì´ ëë‚˜ê¸°ì „ì— ìš°ë¦¬ê°€ ì¤‘ê°„ì— ì¤‘ì§€ë¥¼ í•  ìˆ˜ ìˆë‹¤.</li>\n<li>MiddleWareë¥¼ ì›í•œë‹¤ë©´ ì—¬ëŸ¬ê°œë¥¼ ê³„ì† ì ìš©ì„ í•  ìˆ˜ê°€ ìˆë‹¤.</li>\n<li>ë§Œì•½ì— í˜„ì¬ MiddleWareê°€ ìš”ì²­ ì‚¬ì´í´ì„ ì¤‘ì§€ì‹œí‚¤ì§€ ì•Šê³  ì—ëŸ¬ ê°™ì€ ê²ƒì„ ë˜ì§€ì§€ ì•Šìœ¼ë©´ ë‹¤ìŒ MiddleWareì—ë‹¤ê°€ ìš”ì²­ì„ ë„˜ê¸°ê¸° ìœ„í•´ì„œ next í•¨ìˆ˜ë¥¼ ë¶ˆëŸ¬ì•¼ ëœë‹¤. (ì•ˆ ê·¸ëŸ¬ë©´ ê·¸ëŒ€ë¡œ ë©ˆì¶¤)</li>\n</ul>\n<h3 id=\"ì½”ë“œì˜ˆì‹œ-4\" style=\"position:relative;\"><a href=\"#%EC%BD%94%EB%93%9C%EC%98%88%EC%8B%9C-4\" aria-label=\"ì½”ë“œì˜ˆì‹œ 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì½”ë“œì˜ˆì‹œ</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">test.middleware.ts\n\nimport { NestMiddleware } from '@nestjs/common';\nimport { NextFunction } from 'express';\n\nexport class TestMiddleWare implements NestMiddleware {\n    use(req: Request, res: Response, next: NextFunction) {\n        console.log(\n            `[REQ] ${req.url} ${req.method} ${new Date().toLocaleString('kr')}`,\n        );\n        next();\n    }\n}</code></pre></div>\n<ul>\n<li>ë‹¤ë¥¸ ë¼ì´í”„ì‚¬ì´í´ê³¼ ë‹¤ë¥¸ ì ì€ middlewareëŠ” modlueì— ì‘ì„±ì„ í•œë‹¤.</li>\n<li>NestModuleë¥¼ implementsë¥¼ í•˜ê³  path, methodë¡œ ì›í•˜ëŠ” ê°’ì„ ë°›ì„ ìˆ˜ ìˆë‹¤.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">app.module.ts\n\nimport {\n    MiddlewareConsumer,\n    Module,\n    NestModule,\n    RequestMethod,\n} from '@nestjs/common';\nimport { AppController } from './app.controller';\nimport { AppService } from './app.service';\nimport { TestMiddleWare } from 'src/middleware/test.middleware';\n\n@Module({\n    imports: [],\n    controllers: [AppController],\n    providers: [AppService],\n})\nexport class AppModule implements NestModule {\n    configure(consumer: MiddlewareConsumer) {\n        consumer.apply(TestMiddleWare).forRoutes({\n            path: '/',\n            method: RequestMethod.ALL,\n        });\n    }\n}</code></pre></div>\n<h3 id=\"ê²°ê³¼-4\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EA%B3%BC-4\" aria-label=\"ê²°ê³¼ 4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê²°ê³¼</h3>\n<blockquote>\n<p>[REQ] / GET 12/14/2023, 6:24:48 PM</p>\n</blockquote>","excerpt":"NestjsëŠ” íš¨ìœ¨ì ì´ê³  ìŠ¤ì¼€ì¼ë§ì´ ì‰¬ìš´ nodejs ì„œë²„ë¥¼ ë§Œë“œëŠ”ë° ì‚¬ìš©í•˜ëŠ” í”„ë ˆì„ì›Œí¬ì´ë‹¤. ì°¨ì„¸ëŒ€ Javascriptë¥¼ ì‚¬ìš©í•˜ë©° Typescriptë¡œ ë§Œë“¤ì–´ì¡Œìœ¼ë©° Typescriptë¥¼ ì™„ì „íˆ ì§€ì›í•œë‹¤. NestjsëŠ” Express ê°™ì€ ê²¬ê³ í•œ HTTP ì„œë²„ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë©° ì›í•œë‹¤ë©´ Fastifyë¥¼ ëŒ€ì‹  ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ìƒë‹¹íˆ ë§ì€ Nodejs ë¼ì´ë¸ŒëŸ¬ë¦¬, í—¬í¼, íˆ´ë“¤ì´ ìˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³  ì•„í‚¤í…ì²˜ ì„¤ê³„ì— ëŒ€í•œ ë¬¸ì œë¥¼ í•´ê²°í•´ì£¼ëŠ” í•´ê²°ì±…ì€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤. NestjsëŠ” ìì²´ì ìœ¼ë¡œ ì„œë²„ ì•„í‚¤í…ì³ë¥¼ ì œê³µí•´ì¤€ë‹¤. ê·¸ë˜ì„œ í…ŒìŠ¤íŠ¸í•˜ê¸° ì‰½ê³ , ë””ì»¤í”Œë§ì´ ì˜ ë˜ì–´ìˆê³ , ìœ ì§€ë³´ìˆ˜ê°€ í¸í•œ ì„œë²„ë¥¼ ì œì‘í•˜ê²Œ í•´ì¤€ë‹¤. Nestjs LifeCycle Nestjs LifeCycle Pipe PipeëŠ” Injectable ë°ì½”ë ˆì´í„°ë¡œ ë°ì½”ë ˆì´íŒ… ë˜ì–´ìˆê³ , PipeTransformì´ë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ implementí•œë‹¤. ë³€í˜•: ì›í•˜ëŠ” í˜•íƒœë¡œ ë³€í˜•ì‹œì¼œì¤€ë‹¤ ex) string => integer â€¦","frontmatter":{"date":"March 22, 2021","title":"nestjs","categories":"nestjs ts","author":"minsoku","emoji":"ğŸ¶"},"fields":{"slug":"/nestjs_intro/"}},"next":null,"prev":null},"pageContext":{"slug":"/nestjs_intro/","nextSlug":"","prevSlug":""}},"staticQueryHashes":["1956554647","2938748437"]}